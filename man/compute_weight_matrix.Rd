% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AMIS_steps.R
\name{compute_weight_matrix}
\alias{compute_weight_matrix}
\title{Compute weight matrix across timepoints using appropriate method}
\usage{
compute_weight_matrix(
  likelihoods,
  simulated_prevalence,
  amis_params,
  first_weight,
  locations_first_t,
  is_within_boundaries,
  sim_within_boundaries,
  sim_outside_boundaries,
  which_valid_locs_prev_map
)
}
\arguments{
\item{likelihoods}{An array with dimension n_tims,n_locs,n_sims -- ie timepoints x locations x simulations.}

\item{simulated_prevalence}{An n_sims x n_tims matrix containing the simulated prevalence values for each of the
parameter samples. (double)}

\item{amis_params}{A list of parameters, e.g. from \code{\link{default_amis_params}}.}

\item{first_weight}{A vector containing the values for the right hand side of
the weight expression. Should be of the same length as the rows in \code{simulated_prevalence}.}

\item{locations_first_t}{Vector of length n_locs showing the first time each location appears in the data,
or an NA if there is no data.}

\item{is_within_boundaries}{Logical vector showing which simulated prevalences are valid.}

\item{sim_within_boundaries}{Vector showing which simulated prevalences are valid.}

\item{sim_outside_boundaries}{Vector showing which simulated prevalences are invalid}

\item{which_valid_locs_prev_map}{List showing which locations have valid data at each time}
}
\value{
normalised weight matrix.
}
\description{
Wrapper function to select appropriate method to calculate weight matrix.
}
