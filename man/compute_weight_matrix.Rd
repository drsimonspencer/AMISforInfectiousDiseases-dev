% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AMIS_steps.R
\name{compute_weight_matrix}
\alias{compute_weight_matrix}
\title{Compute weight matrix across timepoints using appropriate method}
\usage{
compute_weight_matrix(
  likelihoods,
  simulated_prevalence,
  amis_params,
  first_weight,
  locs_RN,
  locs_nonRN,
  bool_valid_sim_prev,
  which_valid_sim_prev,
  which_invalid_sim_prev,
  which_valid_locs_prev_map
)
}
\arguments{
\item{likelihoods}{An array with dimension n_tims,n_locs,n_sims -- ie timepoints x locations x simulations.}

\item{simulated_prevalence}{An n_sims x n_tims matrix containing the simulated prevalence values for each of the
parameter samples. (double)}

\item{amis_params}{A list of parameters, e.g. from \code{\link{default_amis_params}}.}

\item{first_weight}{A vector containing the values for the right hand side of
the weight expression. Should be of the same length as the rows in \code{simulated_prevalence}.}

\item{locs_RN}{List indicating, at each time, which locations are updated using the RN derivative.}

\item{locs_nonRN}{List indicating, at each time, which locations are updated without using the RN derivative.}

\item{bool_valid_sim_prev}{Matrix of n_tims columns, where column is a logical vector indicating which simulated prevalences are valid.}

\item{which_valid_sim_prev}{List indicating, at each time, which simulated prevalences are valid.}

\item{which_invalid_sim_prev}{List indicating, at each time, which simulated prevalences are invalid}

\item{which_valid_locs_prev_map}{List showing which locations have valid data at each time}
}
\value{
normalised weight matrix.
}
\description{
Wrapper function to select appropriate method to calculate weight matrix.
}
