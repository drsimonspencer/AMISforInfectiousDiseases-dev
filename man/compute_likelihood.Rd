% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AMIS_steps.R
\name{compute_likelihood}
\alias{compute_likelihood}
\title{Compute likelihood for each additional simulation across timepoints}
\usage{
compute_likelihood(
  prevalence_map,
  simulated_prevalences,
  amis_params,
  likelihoods = NULL,
  which_valid_sim_prev_iter,
  which_valid_prev_map,
  log_norm_const_gaussian
)
}
\arguments{
\item{prevalence_map}{A list with one entry for each timepoint.
Each entry must be a list containing objects \code{data} (an L x M matrix of data);
and optional function \code{likelihood} (see \code{\link{amis}})}

\item{simulated_prevalences}{An n x timepoints matrix of prevalences simulated from the transmission model.}

\item{amis_params}{A list of parameters, e.g. from \code{\link{default_amis_params}}.}

\item{likelihoods}{An array with dimension n_tims,n_locs,n_sims -- ie timepoints x locations x simulations (optional).}

\item{which_valid_sim_prev_iter}{List of T elements, where each one indicates which simulated prevalences are valid at the current iteration}

\item{which_valid_prev_map}{List showing which prevalence map samples are valid}

\item{log_norm_const_gaussian}{Normalising constant (in log scale) for the Gaussian kernel. It is only used if Gaussian kernel is used.}
}
\value{
A larger array with the likelihoods of the new simulations joined to the existing array \code{likelihoods}.
}
\description{
Calls evaluate likelihood for each timepoint.
}
